<!DOCTYPE html><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><meta content="width=device-width, initial-scale=1" name="viewport" /><!--replace-start-0--><!--replace-start-5--><!--replace-start-8--><title>Comparison of Bayesian and frequentist estimators - My Zettelkasten</title><!--replace-end-8--><!--replace-end-5--><!--replace-end-0--><link href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.7/dist/semantic.min.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Merriweather|Libre+Franklin|Roboto+Mono&amp;display=swap" rel="stylesheet" /><!--replace-start-1--><!--replace-start-4--><!--replace-start-7--><link href="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" rel="icon" /><meta content="Bayesian inference relies on the posterior distribution. Commonly used measures of location are the posterior mode, median and mean. Common measures of spread are the posterior variance, standard deviation, the percentiles of the posterior distribution and the interquartile range." name="description" /><meta content="Comparison of Bayesian and frequentist estimators" property="og:title" /><meta content="My Zettelkasten" property="og:site_name" /><meta content="article" property="og:type" /><script type="application/ld+json">[]</script><style type="text/css">body{background-color:#eeeeee !important;font-family:"Libre Franklin", serif !important}body .ui.container{font-family:"Libre Franklin", serif !important}body h1, h2, h3, h4, h5, h6, .ui.header, .headerFont{font-family:"Merriweather", sans-serif !important}body code, pre, tt, .monoFont{font-family:"Roboto Mono","SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace !important}body div.z-index p.info{color:#808080}body div.z-index ul{list-style-type:square;padding-left:1.5em}body div.z-index .uplinks{margin-left:0.29999em}body .zettel-content h1#title-h1{background-color:rgba(33,133,208,0.1)}body nav.bottomPane{background-color:rgba(33,133,208,2.0e-2)}body div#footnotes{border-top-color:#2185d0}body p{line-height:150%}body img{max-width:100%}body .deemphasized{font-size:0.94999em}body .deemphasized:hover{opacity:1}body .deemphasized:not(:hover){opacity:0.69999}body .deemphasized:not(:hover) a{color:#808080 !important}body div.container.universe{padding-top:1em}body div.zettel-view ul{padding-left:1.5em;list-style-type:square}body div.zettel-view .pandoc .highlight{background-color:#ffff00}body div.zettel-view .pandoc .ui.disabled.fitted.checkbox{margin-right:0.29999em;vertical-align:middle}body div.zettel-view .zettel-content .metadata{margin-top:1em}body div.zettel-view .zettel-content .metadata div.date{text-align:center;color:#808080}body div.zettel-view .zettel-content h1{padding-top:0.2em;padding-bottom:0.2em;text-align:center}body div.zettel-view .zettel-content h2{border-bottom:solid 1px #4682b4;margin-bottom:0.5em}body div.zettel-view .zettel-content h3{margin:0px 0px 0.4em 0px}body div.zettel-view .zettel-content h4{opacity:0.8}body div.zettel-view .zettel-content div#footnotes{margin-top:4em;border-top-style:groove;border-top-width:2px;font-size:0.9em}body div.zettel-view .zettel-content div#footnotes ol > li > p:only-of-type{display:inline;margin-right:0.5em}body div.zettel-view .zettel-content aside.footnote-inline{width:30%;padding-left:15px;margin-left:15px;float:right;background-color:#d3d3d3}body div.zettel-view .zettel-content .overflows{overflow:auto}body div.zettel-view .zettel-content code{margin:auto auto auto auto;font-size:100%}body div.zettel-view .zettel-content p code, li code, ol code{padding:0.2em 0.2em 0.2em 0.2em;background-color:#f5f2f0}body div.zettel-view .zettel-content pre{overflow:auto}body div.zettel-view .zettel-content dl dt{font-weight:bold}body div.zettel-view .zettel-content blockquote{background-color:#f9f9f9;border-left:solid 10px #cccccc;margin:1.5em 0px 1.5em 0px;padding:0.5em 10px 0.5em 10px}body div.zettel-view .zettel-content.raw{background-color:#dddddd}body .ui.label.zettel-tag{color:#000000}body .ui.label.zettel-tag a{color:#000000}body nav.bottomPane ul.backlinks > li{padding-bottom:0.4em;list-style-type:disc}body nav.bottomPane ul.context-list > li{list-style-type:lower-roman}body .footer-version img{-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%);-ms-filter:grayscale(100%);-o-filter:grayscale(100%);filter:grayscale(100%)}body .footer-version img:hover{-webkit-filter:grayscale(0%);-moz-filter:grayscale(0%);-ms-filter:grayscale(0%);-o-filter:grayscale(0%);filter:grayscale(0%)}body .footer-version, .footer-version a, .footer-version a:visited{color:#808080}body .footer-version a{font-weight:bold}body .footer-version{margin-top:1em !important;font-size:0.69999em}@media only screen and (max-width: 768px){body div#zettel-container{margin-left:0.4em !important;margin-right:0.4em !important}}body span.zettel-link-container span.zettel-link a{color:#2185d0;font-weight:bold;text-decoration:none}body span.zettel-link-container span.zettel-link a:hover{background-color:rgba(33,133,208,0.1)}body span.zettel-link-container span.extra{color:auto}body span.zettel-link-container.errors{border:solid 1px #ff0000}body span.zettel-link-container.errors span.zettel-link a:hover{text-decoration:none !important;cursor:not-allowed}body [data-tooltip]:after{font-size:0.69999em}body div.tag-tree div.node{font-weight:bold}body div.tag-tree div.node a.inactive{color:#555555}body .tree.flipped{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}body .tree{overflow:auto}body .tree ul.root{padding-top:0px;margin-top:0px}body .tree ul{position:relative;padding:1em 0px 0px 0px;white-space:nowrap;margin:0px auto 0px auto;text-align:center}body .tree ul::after{content:"";display:table;clear:both}body .tree ul:last-child{padding-bottom:0.1em}body .tree li{display:inline-block;vertical-align:top;text-align:center;list-style-type:none;position:relative;padding:1em 0.5em 0em 0.5em}body .tree li::before{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{right:auto;left:50%;border-left:solid 2px #cccccc}body .tree li:only-child{padding-top:0em}body .tree li:only-child::after{display:none}body .tree li:only-child::before{display:none}body .tree li:first-child::before{border-style:none;border-width:0px}body .tree li:first-child::after{border-radius:5px 0px 0px 0px}body .tree li:last-child::after{border-style:none;border-width:0px}body .tree li:last-child::before{border-right:solid 2px #cccccc;border-radius:0px 5px 0px 0px}body .tree ul ul::before{content:"";position:absolute;top:0px;left:50%;border-left:solid 2px #cccccc;width:0px;height:1.19999em}body .tree li div.forest-link{border:solid 2px #cccccc;padding:0.2em 0.29999em 0.2em 0.29999em;text-decoration:none;display:inline-block;border-radius:5px 5px 5px 5px;color:#333333;position:relative;top:2px}body .tree.flipped li div.forest-link{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}</style><!-- MathJax -->
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- Prism.js -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
<!-- Mermaid.js -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
    window.addEventListener("load", mermaid.initialize(
        {
            startOnLoad: true
        }
    ))
</script>
<!-- Custom CSS -->
<link href="./static/style.css" rel="stylesheet" />
<!--replace-end-7--><!--replace-end-4--><!--replace-end-1--></head><body><div class="ui fluid container universe"><!--replace-start-2--><!--replace-start-3--><!--replace-start-6--><nav class="flipped tree deemphasized" id="zettel-uptree" style="transform-origin: 50%"><ul class="root"><li><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-04-06T18:54"><a href="9f8d74d6.html">Methods for statistical analysis 1 (CAMAEI)</a></span></span></div><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-04-05T13:33"><a href="4d2b51b4.html">First semester</a></span></span></div><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-04-04T23:09"><a href=".">Index</a></span></span></div></li></ul></li></ul></li></ul></li></ul></nav><div class="ui text container" id="zettel-container" style="position: relative"><div class="zettel-view"><article class="ui raised attached segment zettel-content"><div class="pandoc"><h1 id="title-h1">Comparison of Bayesian and frequentist estimators</h1><h2 id="bayesian-and-frequentist-inference">Bayesian and frequentist inference</h2><p>Bayesian inference relies on the posterior distribution. Commonly used <strong>measures of location</strong> are the posterior mode, median and mean. Common <strong>measures of spread</strong> are the posterior variance, standard deviation, the percentiles of the posterior distribution and the interquartile range.</p><h3 id="bayesian-and-frequentist-estimators">Bayesian and frequentist estimators</h3><p>We are trying to find some proportion that is unknown. In order to do that, we make an estimation of this proportion. The classical frequentist estimator corresponds to:</p><p><span class="math display">$$
\hat{\pi} = \frac{y}{n}
$$</span></p><p>Where <span class="math inline">\(\hat{\pi}\)</span> is the classic frequentist estimator, <span class="math inline">\(y\)</span> is the number of observations with the characteristic we are interested in, and <span class="math inline">\(n\)</span> the total observations. Which criteria let me compare the estimators?</p><p>The <strong>bias</strong> of the estimator. The difference between the expect value and the real value. The closer the estimation to the expected value, the lesser the bias, the better the estimator.</p><p><span class="math display">$$
\text{bias}(\hat{\theta}) = E(\hat{\theta}) - \theta = \int \hat{\theta}f(\hat{\theta} \mid \theta) d\hat{\theta}-\theta
$$</span></p><p>The <strong>variance</strong> of estimator. Esperanza del estimador menos la esperanza del valor esperado, al cuadrado. The lower the variance, the less spread of data, the better.</p><p><span class="math display">$$
\text{Var}(\hat{\theta}) = E(\hat{\theta} - E(\hat{\theta}))^2
$$</span></p><p>But, what if we have good variance in one and good bias in the other. How to discriminate. In this case, we can use the (frequentist) <strong>mean squared error</strong> of the estimator, which correspond to the sum of the square of the bias plus the variance.</p><p><span class="math display">$$
\begin{align}
\text{MS}(\hat{\theta}) &amp;= E(\hat{\theta} - \theta)^2 \\\\
&amp;= \int (\hat{\theta} - \theta)^2 f(\hat{\theta} \mid \theta) d\hat{\theta} \\\\
&amp;= \text{bias}(\hat{\theta})^2 + \text{Var}(\hat{\theta})
\end{align}
$$</span></p><h3 id="frequentist-estimator-characteristics">Frequentist estimator characteristics</h3><p>Bayesian estimators may have smaller mean squared errors (they are closer to the true value) than frequentist estimators. First, we compute the bias, variance and mean squared error for the frequentist estimators.</p><p>The frequentist estimator has the form:</p><p><span class="math display">$$
\pi_f = y/n
$$</span></p><p>The bias in this case corresponds to zero.</p><p><span class="math display">$$
\begin{align}
E(\pi_f) &amp;= E \left( \frac{y}{n} \right ) \\\\
&amp;= \frac{n\pi}{n} \\\\
&amp;= \pi \\\\
\text{bias} &amp;= E(\pi_f) - \pi \\\\
&amp;= \pi - \pi \\\\
\text{bias} &amp;= 0
\end{align}
$$</span></p><p>The variance computes to <span class="math inline">\(\pi(1-n)/n\)</span>.</p><p><span class="math display">$$
\begin{align}
\text{Var}(\pi_f) &amp;= \text{Var}\left(\frac{y}{n}\right) \\\\
&amp;= \frac{n\pi(1-\pi)}{n^2} \\\\
\text{Var}(\pi_f) &amp;= \frac{\pi(1-\pi)}{n}
\end{align}
$$</span></p><p>Finally, we calculate the mean squared error, which is the bias squared minus the variance, which in this case is equal to the variance itself (the bias is zero).</p><p><span class="math display">$$
\begin{align}
\text{MS} &amp;= \text{bias}^2 + \text{Var} = \text{Var}
\end{align}
$$</span></p><p>So, the characteristics of the frequentist estimator are: (1) is unbiased, and (2) variance is the proportion times 1 minus the proportion, dived by the sample size.</p><h3 id="bayesian-estimator-characteristics">Bayesian estimator characteristics</h3><p>Assume we use a uniform prior <span class="math inline">\(\text{Be}(1,1)\)</span> and the posterior mean as the estimator.</p><p><span class="math display">$$
\begin{align}
\pi_B &amp;= \text{mean}_{\text{posterior}} \\\\
&amp;= \pi^y(1-\pi)^{n-y} \times \pi^0(1-\pi)^0 \\\\
&amp;= \pi^y(1-\pi)^{n-y} \\\\
&amp;\sim \text{Be}(y+1, n-y+1) \\\\
m &amp;= \frac{a}{a+b} \\\\
&amp;= \frac{y+1}{y+1+n-y+1} \\\\
\pi_B &amp;= \frac{y+1}{n+2} \\\\
\end{align}
$$</span></p><p>Already, the frequentist and Bayesian estimators are different. We then compute the bias. We start calculating the esperanaza.</p><p><span class="math display">$$
\begin{align}
E(\pi_B) &amp;= E\left ( \frac{1}{n+2} + \frac{y}{n+2} \right ) \\\\
&amp;= \frac{n\pi}{n+2} + \frac{1}{n+2} \\\\
\text{bias} &amp;= E(\pi_B) - \pi \\\\
&amp;= \left ( \frac{1}{n+2} + \frac{y}{n+2} \right ) \\\\
\text{bias} &amp;= \frac{n\pi}{n+2} + \frac{1}{n+2} - \pi
\end{align}
$$</span></p><p>A disadvantage of this estimator is that is biased. Now we focus on the variance.</p><p><span class="math display">$$
\begin{align}
\text{Var}(\pi_B) &amp;= \text{Var}\left(\frac{y+1}{n+2}\right) \\\\
&amp;= \frac{\pi(1-\pi)n}{(n+2)^2} \\\\
\end{align}
$$</span></p><p>We obtain that the variance of the Bayesian estimator is less than the variance of the frequentist one.</p><p><span class="math display">$$
\begin{align}
\text{Var}(\pi_B) &amp;&lt; \text{Var}(\pi_f) \\\\
\frac{\pi(1-\pi)n}{(n+2)^2} &amp;&lt; \frac{\pi(1-n)}{n}
\end{align}
$$</span></p><p>Now, we have the situation that the bias of frequentist estimators are less than the Bayesian ones, and the variance is the contrary case.</p><h3 id="assignment-8">Assignment 8</h3><p>Imagine you are planning a study to estimate the proportion of patients with complete remission after radiotherapy. You are considering a sample size of <span class="math inline">\(n=20\)</span> patients, a uniform prior and the posterior mean to summarize the posterior distribution.</p><p>Use R to plot the bias, variance and mean square error of the frequentist and the Bayesian estimators of the proportion.</p><p>Interpret the graphs, assuming the proportion of patients with complete remission will likely amount: (a) 40%, (b) 2%.</p><h3 id="solution">Solution</h3><p>R code:</p><pre><code class="R language-R"># We define constants
n &lt;- 20

# We define the dominionn of the proportion
prop &lt;- c(0:100)/100

# Frequentist estimator analysis
E_f &lt;- prop
Bias_f &lt;- E_f - prop
Var_f &lt;- prop*(1-prop)/n
MSE_f &lt;- (Bias_f**2) + Var_f
plot(prop, MSE_f)

# Bayesian estimator analysis
E_b &lt;- (1/(n+2))+((n*prop)/(n+2))
Bias_b &lt;- E_b - prop
Var_b &lt;- (n*prop*(1-prop))/((n+2)**2)
MSE_b &lt;- (Bias_b**2) + Var_b
plot(prop, MSE_b)

# Plot both estimators
plot(prop, MSE_f)
points(prop, MSE_b, col=&quot;blue&quot;)

# Better plot using lines
plot(prop, MSE_f, type=&quot;l&quot;, lab)
lines(prop, MSE_b, col=&quot;blue&quot;)

# Even better plot using ggplot and dplyr
library(ggplot2)
library(dplyr)
df &lt;- data.frame(propr, MSE_f, MSE_b)
df %&gt;%
ggplot() +
geom_point(aes(x=prop, y=MSE_f)) +
geom_line(aes(x=prop, y=MSE_f)) +
geom_point(aes(x=prop, y=MSE_b), col=&quot;blue&quot;) +
geom_line(aes(x=prop, y=MSE_b), col=&quot;blue&quot;)</code></pre><p>If we expect a 40% remission, then the Bayesian estimator is better. If the expected remission is 2%, then it is better to use the frequentist estimator.</p></div><div class="metadata"><div class="date" title="Zettel date"><time datetime="2021-04-16T20:45">2021-04-16</time></div></div></article><nav class="ui attached segment deemphasized backlinksPane" id="neuron-backlinks-pane"><h3 class="ui header"><span title="Backlinks from folgezettel parents">Uplinks</span></h3><ul class="backlinks"><li><span class="zettel-link-container folge"><span class="zettel-link" title="2021-04-06T18:54"><a href="9f8d74d6.html">Methods for statistical analysis 1 (CAMAEI)</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc"><span class="zettel-link-container folge"><span class="zettel-link" title="2021-04-16T20:45"><a href="02ca22d2.html">Comparison of Bayesian and frequentist estimators</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span> — 16/04/2021</div></li></ul></li></ul></nav><nav class="ui attached segment deemphasized bottomPane" id="neuron-tags-pane"><div><span class="ui basic label zettel-tag" title="Tag">CAMAEI/lecture/04</span><span class="ui basic label zettel-tag" title="Tag">prof/Justo-Lorenzo-Bermejo</span><span class="ui basic label zettel-tag" title="Tag">statistics/bayesian</span></div></nav><nav class="ui bottom attached icon compact inverted menu blue" id="neuron-nav-bar"><!--replace-start-9--><a class="item" href="." title="Home"><i class="home icon"></i></a><!--replace-end-9--><a class="right item" href="impulse.html" title="Open Impulse"><i class="wave square icon"></i></a></nav></div></div><!--replace-end-6--><!--replace-end-3--><!--replace-end-2--><div class="ui center aligned container footer-version"><div class="ui tiny image"><a href="https://neuron.zettel.page"><img alt="logo" src="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" title="Generated by Neuron 1.9.25.1" /></a></div></div></div></body></html>